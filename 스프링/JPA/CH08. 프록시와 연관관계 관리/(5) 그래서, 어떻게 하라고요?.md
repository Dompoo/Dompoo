# 그래서, 어떻게 하라고요?

- 연관관계에 있어서 설정할 것이 너-무 많다.
  - 양방향 VS 단방향
  - 연관관계의 주인 위치
  - 영속성 전이 사용여부
  - 고아 객체 제거 사용여부
  - 지연 로딩 VS 즉시 로딩
- 이 복잡성의 시작은 무엇이었을까...
- 바로 양방향 매핑이다.
- N:1 관계에서 N 쪽에만 단방향 매핑을 두면 위 내용들을 고려할 필요가 사라진다.
  - 단방향 사용
  - 주인의 위치는 N쪽이다.
  - 자식 엔티티이므로 영속성 전이 사용이 권장되지 않는다.
  - 자식 엔티티이므로 고아 객체 제거 사용이 권장되지 않는다.
- 아래 폼을 기본으로 두고 필요시에 따로 설정한다고 생각하자.

```java
@Entity
public class Team {
    // 참조 X, 단방향 사용
}

@Entity
public class Member {
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "team_id")
    private Team team;
}
```

- 이러면 심지어 N+1 문제도 발생하지 않는다.
- 순환 참조 문제도 발생하지 않는다.
- 여러 JPA의 기능을 사용하는 것보다 JPA의 복잡성을 통제하고, 생산성 있는 좋은 코드를 작성하려고 노력하자.
