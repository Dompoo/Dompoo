# CAS 연산

- 락을 사용하여 동시성 문제를 해결할 수 있지만 아쉬운 부분이 있다.
- **속도가 너무 느리다.**
  - 락이 있는지 확인한다.
  - 락을 획득하고 임계 영역에 들어간다.
  - 작업을 수행한다.
  - 락을 반납한다.
- 스레드가 많다면 위 작업이 계속해서 반복적으로 실행될 것이다.
- 때문에 락을 걸지 않고 원자적 연산을 수행할 필요가 있었는데, 이를 **CAS** 연산이라고 한다. (Compare And Swap/Set)
  - **CAS** 연산은 락을 완전히 대체하지는 못한다.
  - 거의 모든 영역에 기본적으로 락을 사용한다.

## AtomicInteger의 CAS

`atomicInteger.compareAndSet(25, 10);`

- 메서드명을 보면 너무나 두개의 연산 같다.
  - 메인메모리의 값을 확인한다.
  - 기대하는 값과 같다면 원하는 값으로 변경한다.
- 하지만 CPU 하드웨어적으로 지원되어 원자적으로 실행된다.
  - CPU는 두 과정 사이에 다른 스레드가 값을 변경할 수 없도록 잠깐 막는다.
  - 자바의 **CAS**는 이런 하드웨어적인 지원을 연결하는 인터페이스일 뿐이다.
