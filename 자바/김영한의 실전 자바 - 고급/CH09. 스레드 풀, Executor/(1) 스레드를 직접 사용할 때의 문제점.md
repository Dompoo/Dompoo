# 스레드를 직접 사용할 때의 문제점

- **스레드 생성 시간으로 인한 성능 문제**
  - 메모리 할당 : 스레드의 호출 스택을 위한 메모리를 할당해야 한다.
  - 운영체제 자원 사용 : 스레드 생성 작업은 커널 수준에서 이루어지며, system call을 통해 처리된다.
  - 운영체제 스케줄러 설정 : 운영체제의 스케줄러는 스레드를 관리하고 실행 순서를 조정해야 한다.
  - 이런 생성 시간에 대한 문제를 해결하기 위해 **생성한 스레드를 재사용하는 방법을 고려해볼 수 있다.**
- **스레드 관리 문제**
  - 스레드 개수 : 스레드를 너무 많이 생성하면, CPU나 메모리 자원등이 버티지 못할 수도 있다. 따라서 시스템이 버틸 수 있는 스레드의 개수 내에서 관리되어야 한다.
  - 스레드 종료 : 스레드가 중간에 종료되어야 할 필요가 있을 때, 스레드를 어디선가 관리하고 있어야 한다.
  - 이런 관리 문제를 해결하기 위해 **어디선가 스레드를 관리할 필요성이 있다.**
- **`Runnable` 인터페이스의 불편함**
  - 반환 값이 없다 : `run()` 메서드가 반환값을 가지지 않기 때문에, 결과값을 멤버 변수에 넣어두고, 스레드가 종료된 후에 해당 값을 꺼내어 쓰는 등의 로직이 필요하다.
  - 예외 처리 : `run()` 메서드는 체크 예외를 던질 수 없다. 예외를 메서드 내부에서 처리해야 한다.

## 스레드 풀

- 1, 2번 문제를 해결하기 위해 스레드 풀을 도입할 수 있다.
- 스레드 풀 내부에 미리 필요한 만큼 스레드를 만들어 놓는다.
  - 대기 중인 스레드는 WAITING 상태로 관리된다.
- 작업 요청이 오면 하나 꺼내어 사용하고, 작업이 끝나면 다시 풀에 반납한다.
- 하지만 스레드 풀도 구현하기 어렵다.
  - 스레드 자체가 생산자-소비자 문제가 된다.
  - 상태 변환을 매번 바꿔주기 어렵다.
- 자바의 `Executor` 프레임워크를 사용하여 이런 문제들을 한방에 해결할 수 있다.
